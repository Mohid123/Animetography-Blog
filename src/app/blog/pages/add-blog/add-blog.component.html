<section class="top-section">
  <app-header></app-header>
  <div class="pt-32 sm:pt-40">
    <h1 class="z-50 sm:text-4xl text-2xl text-center text-white font-[Mukta]">Storytelling in Animation</h1>
  </div>
</section>

<tui-tabs tuiMobileTabs class="mx-2 lg:mx-20 md:mx-10" [activeItemIndex]="activeIndex">
  <ng-container *ngFor="let item of items; let i = index">
    <button
      tuiTab
      tuiRipple="var(--tui-text-01)"
      (click)="i === 0 ? activeIndex = 0 : activeIndex = 1"
    >
    <img [ngSrc]="item.icon" alt="svg-icon" width="28" height="28" class="pr-2 w-7 h-7">
    {{item.text}}
  </button>
  </ng-container>
</tui-tabs>

<section *ngIf="activeIndex === 0" class="add-section">
  <h3 class="px-5 pb-4 text-2xl font-semibold text-white">Create New Post</h3>
  <form [formGroup]="blogPostForm" class="px-5">
    <div class="pb-3">
      <tui-input
      formControlName="blogTitle"
      [tuiTextfieldCleaner]="true"
    >
    Post Title&nbsp;
    <span class="tui-required"></span>
    <input
      tuiTextfield
      placeholder="Title"
      type="text"
    />
    </tui-input>
    <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
      validation: 'required',
      message: 'Please provide a title for the post',
      control: f['blogTitle']
    }">
    </ng-container>
    </div>
    <div class="pb-3">
      <tui-text-area
      formControlName="blogSubtitle"
      [tuiTextfieldCleaner]="true"
      [expandable]="true"
    >
    Summary&nbsp;
    <span class="tui-required"></span>
    </tui-text-area>
    <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
      validation: 'required',
      message: 'Please provide a summary for the post',
      control: f['blogSubtitle']
    }">
    </ng-container>
    </div>
    <div class="pb-3">
      <tui-editor
        formControlName="blogContent"
        class="h-100"
        (fileAttached)="attach($event)"
        [tools]="builtInTools"
      >
        <ng-container ngProjectAs="tools">
          <youtube-tool tuiItem></youtube-tool>
        </ng-container>
      </tui-editor>
    </div>
    <div class="pb-3">
      <tui-input-files
        class="bg-white rounded-lg"
        *ngIf="!f['coverImage'].value"
        accept="image/*"
        formControlName="coverImage"
        (reject)="onReject($event)"
      ></tui-input-files>

      <tui-files class="tui-space_top-1">
        <tui-file
          *ngIf="loadedFiles$ | async as file"
          [file]="file"
          [showDelete]="f['coverImage'].enabled"
          (removed)="removeFile()"
        ></tui-file>

        <tui-file
          *ngIf="rejectedFiles$ | async as file"
          state="error"
          [file]="file"
          [showDelete]="f['coverImage'].enabled"
          (removed)="clearRejected()"
        ></tui-file>

        <tui-file
          *ngIf="loadingFiles$ | async as file"
          state="loading"
          [file]="file"
          [showDelete]="f['coverImage'].enabled"
        ></tui-file>
      </tui-files>
    </div>
  </form>
</section>

<section class="py-4 mx-2 lg:mx-20 md:mx-10" *ngIf="activeIndex === 1" tuiTab>
  <div class="flex flex-col bg-white shadow-xl">
    <div class="w-full">
      <img class="object-cover w-full h-full" width="800" height="400" ngSrc="https://placehold.co/800x400?text=Cover+Image+Goes+Here" alt="placeholder_img">
    </div>
    <article class="w-full px-4 py-3">
      <h2 class="text-3xl font-semibold">Post Title </h2>
      <p class="my-3 text-lg font-medium text-gray-500">
        Post Summary
      </p>
      <div class="flex justify-start mb-1">
        <tui-avatar
          text="Frolbercheri Frol"
          size="l"
          class="mr-3 tui-space_top-1"
          [rounded]="true"
        ></tui-avatar>
        <div class="flex flex-col pb-2 my-1">
          <p class="my-2">Author's Name</p>
          <p>{{today | date: 'longDate'}}</p>
        </div>
      </div>
      <div class="px-2 py-5">
        <hr class="h-1">
      </div>
      <div class="text-base leading-loose lg:px-2" [innerHTML]="'<p>Post Content</p>'"></div>
      <div class="px-2 py-5">
        <hr class="h-1">
      </div>
    </article>
  </div>
</section>
<br>

<ng-template #formError let-control="control" let-message="message" let-validation="validation">
  <ng-container *ngIf="control.hasError(validation) && (control.dirty || control.touched)">
    <div class="w-full mt-1 text-left fv-plugins-message-container text-xxs 2xl:text-xs">
      <span class="text-xs text-red-600 fv-help-block 2xl:mb-2" role="alert">
        {{ message }}
      </span>
    </div>
  </ng-container>
</ng-template>
